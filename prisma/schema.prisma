generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                     String                   @id @default(uuid())
  nombres                String                   @db.VarChar(255)
  apellidoPaterno        String                   @db.VarChar(255)
  apellidoMaterno        String                   @db.VarChar(255)
  email                  String                   @unique @db.VarChar(255)
  password               String                   @db.VarChar(255)
  telefono               String?                  @db.VarChar(50)
  rol                    Rol                      @default(repartidor)
  tipoRepartidor         TipoRepartidor?          @map("tipo_repartidor")
  estado                 Estado                   @default(activo)
  sede                   String?                  @db.VarChar(255)
  twoFactorSecret        String?                  @db.VarChar(255)
  isTwoFactorEnabled     Boolean                  @default(false)
  fechaRegistro          DateTime                 @default(now())
  createdAt              DateTime                 @default(now()) @map("created_at")
  updatedAt              DateTime                 @updatedAt @map("updated_at")
  descuentosRepartidor   DescuentoRepartidor[]
  historialLimiteCredito HistorialLimiteCredito[]
  pedidos                Pedido[]
  rutas                  UsuarioRuta[]
  cortesCaja             CorteCaja[]

  @@map("usuarios")
}

model Sede {
  id              String          @id @default(uuid())
  nombre          String          @db.VarChar(255)
  direccion       String          @db.VarChar(500)
  telefono        String          @db.VarChar(50)
  email           String          @db.VarChar(255)
  estado          EstadoSede      @default(activa)
  fechaCreacion   DateTime        @default(now()) @map("fecha_creacion")
  createdAt       DateTime        @default(now()) @map("created_at")
  updatedAt       DateTime        @updatedAt @map("updated_at")
  formasPago      FormaPago[]
  formasPagoSedes FormaPagoSede[]
  pedidos         Pedido[]
  productos       Producto[]
  rutas           Ruta[]

  @@map("sedes")
}

model FormaPago {
  id                  String          @id @default(uuid())
  nombre              String          @db.VarChar(255)
  tipo                TipoFormaPago
  descripcion         String          @db.VarChar(500)
  activa              Boolean         @default(true)
  requiereValidacion  Boolean         @default(false)
  requiereFolio       Boolean         @default(false)
  comisionPorcentaje  Float           @default(0)
  diasLiquidacion     Int             @default(0)
  bancoAsociado       String?         @db.VarChar(255)
  requiereComprobante Boolean         @default(false)
  permiteCambio       Boolean         @default(true)
  limiteMaximo        Float?
  limiteMinimo        Float?
  sedeId              String?         @map("sede_id")
  usuarioCreacion     String          @db.VarChar(255)
  usuarioModificacion String          @db.VarChar(255)
  fechaCreacion       DateTime        @default(now()) @map("fecha_creacion")
  fechaModificacion   DateTime        @updatedAt @map("fecha_modificacion")
  createdAt           DateTime        @default(now()) @map("created_at")
  updatedAt           DateTime        @updatedAt @map("updated_at")
  abonos              AbonoCliente[]
  sede                Sede?           @relation(fields: [sedeId], references: [id])
  sedes               FormaPagoSede[]
  pagosFormaPago      PagoFormaPago[]
  pagosPedido         PagoPedido[]

  @@index([sedeId], map: "formas_pago_sede_id_fkey")
  @@map("formas_pago")
}

model FormaPagoSede {
  id          String    @id @default(uuid())
  formaPagoId String    @map("forma_pago_id")
  sedeId      String    @map("sede_id")
  createdAt   DateTime  @default(now()) @map("created_at")
  formaPago   FormaPago @relation(fields: [formaPagoId], references: [id], onDelete: Cascade)
  sede        Sede      @relation(fields: [sedeId], references: [id], onDelete: Cascade)

  @@unique([formaPagoId, sedeId])
  @@index([sedeId], map: "formas_pago_sedes_sede_id_fkey")
  @@map("formas_pago_sedes")
}

model TipoFormaPagoConfig {
  id                String   @id @default(uuid())
  codigo            String   @db.VarChar(50)
  nombre            String   @db.VarChar(255)
  descripcion       String?  @db.VarChar(500)
  activo            Boolean  @default(true)
  icono             String?  @db.VarChar(50)
  color             String?  @db.VarChar(50)
  orden             Int      @default(0)
  fechaCreacion     DateTime @default(now()) @map("fecha_creacion")
  fechaModificacion DateTime @updatedAt @map("fecha_modificacion")
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")

  @@map("tipos_forma_pago")
}

model Ruta {
  id                  String        @id @default(uuid())
  nombre              String        @db.VarChar(255)
  codigo              String        @unique @db.VarChar(50)
  descripcion         String?       @db.VarChar(500)
  zona                String        @db.VarChar(100)
  zonaId              String?       @map("zona_id")
  activa              Boolean       @default(true)
  horarioInicio       String?       @db.VarChar(10)
  horarioFin          String?       @db.VarChar(10)
  usuarioCreacion     String        @db.VarChar(255)
  usuarioModificacion String        @db.VarChar(255)
  fechaCreacion       DateTime      @default(now()) @map("fecha_creacion")
  fechaModificacion   DateTime      @updatedAt @map("fecha_modificacion")
  createdAt           DateTime      @default(now()) @map("created_at")
  updatedAt           DateTime      @updatedAt @map("updated_at")
  sedeId              String?       @map("sede_id")
  clientes            Cliente[]
  pedidos             Pedido[]
  sede                Sede?         @relation(fields: [sedeId], references: [id])
  zonaRelacion        Zona?         @relation(fields: [zonaId], references: [id])
  repartidores        UsuarioRuta[]

  @@index([sedeId], map: "rutas_sede_id_fkey")
  @@index([zonaId], map: "rutas_zona_id_fkey")
  @@map("rutas")
}

model UsuarioRuta {
  id        String  @id @default(uuid())
  rutaId    String  @map("ruta_id")
  usuarioId String  @map("usuario_id")
  ruta      Ruta    @relation(fields: [rutaId], references: [id], onDelete: Cascade)
  usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([rutaId, usuarioId])
  @@index([usuarioId], map: "usuario_ruta_usuario_id_fkey")
  @@map("usuario_ruta")
}

model Ciudad {
  id            String      @id @default(uuid())
  nombre        String?     @db.VarChar(255)
  codigo        String?     @db.VarChar(50)
  estado        String      @db.VarChar(100)
  activa        Boolean     @default(true)
  fechaCreacion DateTime    @default(now()) @map("fecha_creacion")
  createdAt     DateTime    @default(now()) @map("created_at")
  updatedAt     DateTime    @updatedAt @map("updated_at")
  municipios    Municipio[]

  @@map("ciudades")
}

model Municipio {
  id            String   @id @default(uuid())
  nombre        String   @db.VarChar(255)
  codigo        String?  @db.VarChar(50)
  ciudadId      String   @map("ciudad_id")
  activo        Boolean  @default(true)
  fechaCreacion DateTime @default(now()) @map("fecha_creacion")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  ciudad        Ciudad   @relation(fields: [ciudadId], references: [id], onDelete: Cascade)
  zonas         Zona[]

  @@index([ciudadId], map: "municipios_ciudad_id_fkey")
  @@map("municipios")
}

model Zona {
  id            String    @id @default(uuid())
  nombre        String    @db.VarChar(255)
  codigo        String?   @db.VarChar(50)
  descripcion   String?   @db.VarChar(500)
  municipioId   String    @map("municipio_id")
  activa        Boolean   @default(true)
  fechaCreacion DateTime  @default(now()) @map("fecha_creacion")
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")
  rutas         Ruta[]
  clientes      Cliente[]
  municipio     Municipio @relation(fields: [municipioId], references: [id], onDelete: Cascade)

  @@index([municipioId], map: "zonas_municipio_id_fkey")
  @@map("zonas")
}

model Cliente {
  id                         String                   @id @default(uuid())
  nombre                     String                   @db.VarChar(255)
  apellidoPaterno            String                   @db.VarChar(255)
  apellidoMaterno            String                   @db.VarChar(255)
  email                      String?                  @unique @db.VarChar(255)
  telefono                   String                   @db.VarChar(50)
  telefonoSecundario         String?                  @db.VarChar(50)
  calle                      String                   @db.VarChar(255)
  numeroExterior             String                   @db.VarChar(20)
  numeroInterior             String?                  @db.VarChar(20)
  colonia                    String                   @db.VarChar(255)
  municipio                  String                   @db.VarChar(255)
  estado                     String                   @db.VarChar(100)
  codigoPostal               String                   @db.VarChar(10)
  rfc                        String?                  @db.VarChar(20)
  curp                       String?                  @db.VarChar(20)
  rutaId                     String?                  @map("ruta_id")
  zonaId                     String?                  @map("zona_id")
  limiteCredito              Float                    @default(0)
  saldoActual                Float                    @default(0)
  pagosEspecialesAutorizados Boolean                  @default(false)
  estadoCliente              EstadoCliente            @default(activo)
  fechaRegistro              DateTime                 @default(now()) @map("fecha_registro")
  ultimaModificacion         DateTime                 @updatedAt @map("ultima_modificacion")
  createdAt                  DateTime                 @default(now()) @map("created_at")
  updatedAt                  DateTime                 @updatedAt @map("updated_at")
  abonos                     AbonoCliente[]
  ruta                       Ruta?                    @relation(fields: [rutaId], references: [id])
  zona                       Zona?                    @relation(fields: [zonaId], references: [id])
  domicilios                 Domicilio[]
  historialLimiteCredito     HistorialLimiteCredito[]
  notasCredito               NotaCredito[]
  pagos                      Pago[]
  pedidos                    Pedido[]

  @@index([rutaId], map: "clientes_ruta_id_fkey")
  @@index([zonaId], map: "clientes_zona_id_fkey")
  @@map("clientes")
}

model Domicilio {
  id              String        @id @default(uuid())
  clienteId       String        @map("cliente_id")
  tipo            TipoDomicilio
  calle           String        @db.VarChar(255)
  numeroExterior  String        @db.VarChar(20)
  numeroInterior  String?       @db.VarChar(20)
  colonia         String        @db.VarChar(255)
  municipio       String        @db.VarChar(255)
  estado          String        @db.VarChar(100)
  codigoPostal    String        @db.VarChar(10)
  referencia      String?       @db.VarChar(500)
  latitud         Float?        @db.Double
  longitud        Float?        @db.Double
  activo          Boolean       @default(true)
  codigoQR        String        @unique @db.VarChar(50)
  fechaCreacionQR DateTime      @default(now()) @map("fecha_creacion_qr")
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime      @updatedAt @map("updated_at")
  cliente         Cliente       @relation(fields: [clienteId], references: [id], onDelete: Cascade)

  @@index([clienteId], map: "domicilios_cliente_id_fkey")
  @@map("domicilios")
}

model CategoriaProducto {
  id                String     @id @default(uuid())
  nombre            String     @unique @db.VarChar(100)
  codigo            String     @unique @db.VarChar(50)
  descripcion       String?    @db.VarChar(500)
  activa            Boolean    @default(true)
  fechaCreacion     DateTime   @default(now()) @map("fecha_creacion")
  fechaModificacion DateTime   @updatedAt @map("fecha_modificacion")
  createdAt         DateTime   @default(now()) @map("created_at")
  updatedAt         DateTime   @updatedAt @map("updated_at")
  productos         Producto[]

  @@map("categorias_producto")
}

model Producto {
  id                String            @id @default(uuid())
  nombre            String            @db.VarChar(255)
  categoriaId       String            @map("categoria_id")
  precio            Float
  unidad            String            @db.VarChar(50)
  descripcion       String?           @db.VarChar(500)
  cantidadKilos     Float?            @map("cantidad_kilos")
  activo            Boolean           @default(true)
  sedeId            String?           @map("sede_id")
  fechaCreacion     DateTime          @default(now()) @map("fecha_creacion")
  fechaModificacion DateTime          @updatedAt @map("fecha_modificacion")
  createdAt         DateTime          @default(now()) @map("created_at")
  updatedAt         DateTime          @updatedAt @map("updated_at")
  pedidosProducto   PedidoProducto[]
  categoria         CategoriaProducto @relation(fields: [categoriaId], references: [id])
  sede              Sede?             @relation(fields: [sedeId], references: [id])

  @@index([categoriaId], map: "productos_categoria_id_fkey")
  @@index([sedeId], map: "productos_sede_id_fkey")
  @@map("productos")
}

model Pedido {
  id                String           @id @default(uuid())
  numeroPedido      String           @unique @db.VarChar(50)
  clienteId         String           @map("cliente_id")
  rutaId            String?          @map("ruta_id")
  fechaPedido       DateTime         @map("fecha_pedido")
  horaPedido        String           @map("hora_pedido") @db.VarChar(10)
  estado            EstadoPedido     @default(pendiente)
  cantidadProductos Int              @default(0) @map("cantidad_productos")
  ventaTotal        Float            @default(0) @map("venta_total")
  tipoServicio      TipoServicio     @map("tipo_servicio")
  repartidorId      String?          @map("repartidor_id")
  observaciones     String?          @db.VarChar(1000)
  sedeId            String?          @map("sede_id")
  fechaCreacion     DateTime         @default(now()) @map("fecha_creacion")
  fechaModificacion DateTime         @updatedAt @map("fecha_modificacion")
  createdAt         DateTime         @default(now()) @map("created_at")
  updatedAt         DateTime         @updatedAt @map("updated_at")
  calculoPipas      String?          @map("calculo_pipas") @db.LongText
  formasPago        String?          @map("formas_pago") @db.LongText
  montoPagado       Float            @default(0) @map("monto_pagado")
  notasCredito      NotaCredito[]
  pagos             PagoPedido[]
  productosPedido   PedidoProducto[]
  cliente           Cliente          @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  repartidor        Usuario?         @relation(fields: [repartidorId], references: [id])
  ruta              Ruta?            @relation(fields: [rutaId], references: [id])
  sede              Sede?            @relation(fields: [sedeId], references: [id])

  @@index([clienteId], map: "pedidos_cliente_id_fkey")
  @@index([repartidorId], map: "pedidos_repartidor_id_fkey")
  @@index([rutaId], map: "pedidos_ruta_id_fkey")
  @@index([sedeId], map: "pedidos_sede_id_fkey")
  @@map("pedidos")
}

model PedidoProducto {
  id         String   @id @default(uuid())
  pedidoId   String   @map("pedido_id")
  productoId String   @map("producto_id")
  cantidad   Int
  precio     Float
  subtotal   Float
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")
  pedido     Pedido   @relation(fields: [pedidoId], references: [id], onDelete: Cascade)
  producto   Producto @relation(fields: [productoId], references: [id], onDelete: Cascade)

  @@index([pedidoId], map: "pedido_productos_pedido_id_fkey")
  @@index([productoId], map: "pedido_productos_producto_id_fkey")
  @@map("pedido_productos")
}

model NotaCredito {
  id                String            @id @default(uuid())
  numeroNota        String            @unique @map("numero_nota") @db.VarChar(50)
  clienteId         String            @map("cliente_id")
  pedidoId          String?           @map("pedido_id")
  fechaVenta        DateTime          @map("fecha_venta")
  fechaVencimiento  DateTime          @map("fecha_vencimiento")
  importe           Float
  saldoPendiente    Float             @default(0) @map("saldo_pendiente")
  diasVencimiento   Int               @default(0) @map("dias_vencimiento")
  estado            EstadoNotaCredito @default(vigente)
  observaciones     String?           @db.VarChar(1000)
  fechaCreacion     DateTime          @default(now()) @map("fecha_creacion")
  fechaModificacion DateTime          @updatedAt @map("fecha_modificacion")
  createdAt         DateTime          @default(now()) @map("created_at")
  updatedAt         DateTime          @updatedAt @map("updated_at")
  abonos            AbonoCliente[]
  cliente           Cliente           @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  pedido            Pedido?           @relation(fields: [pedidoId], references: [id])
  pagos             Pago[]

  @@index([clienteId], map: "notas_credito_cliente_id_fkey")
  @@index([pedidoId], map: "notas_credito_pedido_id_fkey")
  @@map("notas_credito")
}

model Pago {
  id                  String          @id @default(uuid())
  clienteId           String          @map("cliente_id")
  notaCreditoId       String?         @map("nota_credito_id")
  montoTotal          Float           @map("monto_total")
  tipo                TipoPago
  fechaPago           DateTime        @map("fecha_pago")
  horaPago            String          @map("hora_pago") @db.VarChar(10)
  observaciones       String?         @db.VarChar(1000)
  usuarioRegistro     String          @map("usuario_registro")
  usuarioAutorizacion String?         @map("usuario_autorizacion")
  estado              EstadoPago      @default(pendiente)
  fechaCreacion       DateTime        @default(now()) @map("fecha_creacion")
  fechaModificacion   DateTime        @updatedAt @map("fecha_modificacion")
  createdAt           DateTime        @default(now()) @map("created_at")
  updatedAt           DateTime        @updatedAt @map("updated_at")
  formasPago          PagoFormaPago[]
  cliente             Cliente         @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  notaCredito         NotaCredito?    @relation(fields: [notaCreditoId], references: [id])

  @@index([clienteId], map: "pagos_cliente_id_fkey")
  @@index([notaCreditoId], map: "pagos_nota_credito_id_fkey")
  @@map("pagos")
}

model AbonoCliente {
  id              String       @id @default(uuid())
  clienteId       String       @map("cliente_id")
  monto           Float
  fecha           DateTime     @default(now())
  formaPagoId     String       @map("forma_pago_id")
  folio           String?      @db.VarChar(255)
  notaCreditoId   String?      @map("nota_credito_id")
  usuarioRegistro String       @map("usuario_registro")
  observaciones   String?      @db.VarChar(1000)
  createdAt       DateTime     @default(now()) @map("created_at")
  updatedAt       DateTime     @updatedAt @map("updated_at")
  cliente         Cliente      @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  formaPago       FormaPago    @relation(fields: [formaPagoId], references: [id])
  notaCredito     NotaCredito? @relation(fields: [notaCreditoId], references: [id])

  @@index([clienteId], map: "abonos_cliente_cliente_id_fkey")
  @@index([formaPagoId], map: "abonos_cliente_forma_pago_id_fkey")
  @@index([notaCreditoId], map: "abonos_cliente_nota_credito_id_fkey")
  @@map("abonos_cliente")
}

model PagoFormaPago {
  id          String    @id @default(uuid())
  pagoId      String    @map("pago_id")
  formaPagoId String    @map("forma_pago_id")
  monto       Float
  referencia  String?   @db.VarChar(255)
  banco       String?   @db.VarChar(255)
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")
  formaPago   FormaPago @relation(fields: [formaPagoId], references: [id], onDelete: Cascade)
  pago        Pago      @relation(fields: [pagoId], references: [id], onDelete: Cascade)

  @@index([formaPagoId], map: "pago_forma_pago_forma_pago_id_fkey")
  @@index([pagoId], map: "pago_forma_pago_pago_id_fkey")
  @@map("pago_forma_pago")
}

model HistorialLimiteCredito {
  id             String   @id @default(uuid())
  clienteId      String   @map("cliente_id")
  usuarioId      String   @map("usuario_id")
  limiteAnterior Float    @map("limite_anterior")
  limiteNuevo    Float    @map("limite_nuevo")
  motivo         String   @db.VarChar(500)
  fechaCreacion  DateTime @default(now()) @map("fecha_creacion")
  createdAt      DateTime @default(now()) @map("created_at")
  cliente        Cliente  @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  usuario        Usuario  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@index([clienteId], map: "historial_limite_credito_cliente_id_fkey")
  @@index([usuarioId], map: "historial_limite_credito_usuario_id_fkey")
  @@map("historial_limite_credito")
}

model NewsletterItem {
  id                  String             @id @default(uuid())
  type                TipoNewsletterItem
  title               String?            @db.VarChar(255)
  content             String?            @db.Text
  description         String?            @db.VarChar(500)
  imageUrl            String?            @db.LongText
  fechaVencimiento    DateTime?          @map("fecha_vencimiento")
  size                Tama単oNewsletter? @default(medium)
  activo              Boolean            @default(true)
  usuarioCreacion     String?            @map("usuario_creacion")
  usuarioModificacion String?            @map("usuario_modificacion")
  fechaCreacion       DateTime           @default(now()) @map("fecha_creacion")
  fechaModificacion   DateTime           @updatedAt @map("fecha_modificacion")
  createdAt           DateTime           @default(now()) @map("created_at")
  updatedAt           DateTime           @updatedAt @map("updated_at")

  @@map("newsletter_items")
}

model Configuracion {
  id                  String   @id @default(uuid())
  precioPorLitroGasLP Float    @default(18.5) @map("precio_por_litro_gas_lp")
  precioPorKG         Float    @default(18.5) @map("precio_por_kg")
  fechaCreacion       DateTime @default(now()) @map("fecha_creacion")
  fechaModificacion   DateTime @updatedAt @map("fecha_modificacion")
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")

  @@map("configuraciones")
}

model ConfiguracionTicket {
  id                      String   @id @default(uuid())
  tipoTicket              String   @default("venta") @db.VarChar(50) @map("tipo_ticket")
  nombreEmpresa           String   @db.VarChar(255) @map("nombre_empresa")
  razonSocial             String?  @db.VarChar(500) @map("razon_social")
  direccion               String?  @db.VarChar(500)
  telefono                String?  @db.VarChar(50)
  email                   String?  @db.VarChar(255)
  sitioWeb                String?  @db.VarChar(255) @map("sitio_web")
  rfc                     String?  @db.VarChar(20)
  logo                    String?  @db.Text
  mostrarLogo             Boolean  @default(true) @map("mostrar_logo")
  tama単oLogo              String   @default("mediano") @db.VarChar(20) @map("tama単o_logo")
  redesSocialesFacebook   String?  @db.VarChar(255) @map("redes_sociales_facebook")
  redesSocialesInstagram  String?  @db.VarChar(255) @map("redes_sociales_instagram")
  redesSocialesTwitter    String?  @db.VarChar(255) @map("redes_sociales_twitter")
  redesSocialesLinkedin   String?  @db.VarChar(255) @map("redes_sociales_linkedin")
  redesSocialesWhatsapp   String?  @db.VarChar(255) @map("redes_sociales_whatsapp")
  mostrarRedesSociales    Boolean  @default(true) @map("mostrar_redes_sociales")
  textoEncabezado         String?  @db.VarChar(500) @map("texto_encabezado")
  textoPiePagina          String?  @db.VarChar(500) @map("texto_pie_pagina")
  mensajeEspecial         String?  @db.VarChar(1000) @map("mensaje_especial")
  mostrarMensajeEspecial   Boolean  @default(false) @map("mostrar_mensaje_especial")
  mostrarFecha            Boolean  @default(true) @map("mostrar_fecha")
  mostrarHora             Boolean  @default(true) @map("mostrar_hora")
  mostrarCajero           Boolean  @default(true) @map("mostrar_cajero")
  mostrarCliente           Boolean  @default(true) @map("mostrar_cliente")
  colorPrincipal           String   @default("#1976d2") @db.VarChar(20) @map("color_principal")
  alineacion               String   @default("centro") @db.VarChar(20)
  activo                   Boolean  @default(true)
  fechaCreacion            DateTime @default(now()) @map("fecha_creacion")
  fechaModificacion        DateTime @updatedAt @map("fecha_modificacion")
  createdAt                DateTime @default(now()) @map("created_at")
  updatedAt                DateTime @updatedAt @map("updated_at")

  @@unique([tipoTicket])
  @@map("configuracion_tickets")
}

model DescuentoRepartidor {
  id                  String   @id @default(uuid())
  repartidorId        String   @map("repartidor_id")
  nombre              String?  @db.VarChar(255)
  descripcion         String?  @db.VarChar(500)
  descuentoAutorizado Float    @default(0) @map("descuento_autorizado")
  descuentoPorLitro   Float?   @map("descuento_por_litro")
  activo              Boolean  @default(true)
  fechaCreacion       DateTime @default(now()) @map("fecha_creacion")
  fechaModificacion   DateTime @updatedAt @map("fecha_modificacion")
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")
  repartidor          Usuario  @relation(fields: [repartidorId], references: [id], onDelete: Cascade)

  @@map("descuentos_repartidor")
}

model PagoPedido {
  id           String         @id @default(uuid())
  pedidoId     String         @map("pedido_id")
  monto        Float
  folio        String?        @db.VarChar(255)
  tipo         TipoPagoPedido
  metodoId     String?        @map("metodo_id")
  fecha        DateTime       @default(now())
  firmaCliente String?        @map("firma_cliente") @db.Text
  pedido       Pedido         @relation(fields: [pedidoId], references: [id], onDelete: Cascade)
  metodo       FormaPago?     @relation(fields: [metodoId], references: [id], onDelete: SetNull)

  @@index([pedidoId], map: "pagos_pedidos_pedido_id_fkey")
  @@index([metodoId], map: "pagos_pedidos_metodo_id_fkey")
  @@map("pagos_pedidos")
}

model CorteCaja {
  id            String              @id @default(uuid())
  repartidorId  String              @map("repartidor_id")
  repartidor    Usuario             @relation(fields: [repartidorId], references: [id])
  fecha         DateTime            @default(now())
  tipo          TipoCorte           @map("tipo_corte")
  totalVentas   Float               @default(0) @map("total_ventas")
  totalAbonos   Float               @default(0) @map("total_abonos")
  totalEfectivo Float               @default(0) @map("total_efectivo")
  totalOtros    Float               @default(0) @map("total_otros")
  estado        EstadoCorte         @default(pendiente)
  observaciones String?             @db.VarChar(1000)
  createdAt     DateTime            @default(now()) @map("created_at")
  updatedAt     DateTime            @updatedAt @map("updated_at")
  dia           String              @db.VarChar(10)
  depositos     CorteCajaDeposito[]
  detalles      CorteCajaDetalle[]

  @@unique([repartidorId, dia, tipo])
  @@map("cortes_caja")
}

model CorteCajaDetalle {
  id             String              @id @default(uuid())
  corteId        String              @map("corte_id")
  referenciaId   String              @map("referencia_id")
  tipoReferencia TipoReferenciaCorte @map("tipo_referencia")
  monto          Float
  formaPago      String?             @map("forma_pago")
  createdAt      DateTime            @default(now()) @map("created_at")
  corte          CorteCaja           @relation(fields: [corteId], references: [id], onDelete: Cascade)

  @@index([corteId], map: "cortes_caja_detalles_corte_id_fkey")
  @@map("cortes_caja_detalles")
}

model CorteCajaDeposito {
  id                 String    @id @default(uuid())
  corteId            String    @map("corte_id")
  monto              Float
  folio              String    @db.VarChar(255)
  billetesRechazados Float     @default(0) @map("billetes_rechazados")
  monedas            Float     @default(0) @map("monedas")
  total              Float
  createdAt          DateTime  @default(now()) @map("created_at")
  corte              CorteCaja @relation(fields: [corteId], references: [id], onDelete: Cascade)

  @@index([corteId], map: "cortes_caja_depositos_corte_id_fkey")
  @@map("cortes_caja_depositos")
}

enum Rol {
  superAdministrador
  administrador
  gestor
  repartidor
}

enum Estado {
  activo
  inactivo
}

enum TipoRepartidor {
  cilindros
  pipas
}

enum EstadoSede {
  activa
  inactiva
}

enum TipoFormaPago {
  efectivo
  terminal
  transferencia
  cheque
  deposito
  credito
}

enum EstadoCliente {
  activo
  suspendido
  inactivo
}

enum TipoDomicilio {
  principal
  facturacion
  entrega
  otro
}

enum EstadoPedido {
  entregado
  pendiente
  cancelado
  en_proceso
}

enum TipoServicio {
  pipas
  cilindros
}

enum EstadoNotaCredito {
  vigente
  por_vencer
  vencida
  pagada
  cancelada
}

enum EstadoPago {
  pendiente
  autorizado
  rechazado
  cancelado
}

enum TipoPago {
  nota_especifica
  abono_general
}

enum TipoNewsletterItem {
  image
  notification
}

enum Tama単oNewsletter {
  small
  medium
  large
}

enum TipoPagoPedido {
  metodo_pago
  credito
}

enum TipoCorte {
  venta_dia
  abono
}

enum EstadoCorte {
  pendiente
  validado
  rechazado
}

enum TipoReferenciaCorte {
  pedido
  abono
}
